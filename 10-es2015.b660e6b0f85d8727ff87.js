(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"632m":function(e,s,t){"use strict";t.r(s),t.d(s,"UserModule",(function(){return M}));var n=t("ofXK"),r=t("3Pt+"),i=t("ZZCA"),o=t("Lm2G"),l=t("tyNb"),u=t("QR1q"),c=t("5vxX"),a=t("lSn3"),h=t("jZhJ"),p=t("0Tvr"),b=t("fXoL"),d=t("4Q0Y");function m(e,s){1&e&&(b.Yb(0,"div",16),b.Yb(1,"div",17),b.Tb(2,"div",18),b.Xb(),b.Xb())}function f(e,s){if(1&e){const e=b.Zb();b.Yb(0,"span",19),b.gc("click",(function(){return b.Ec(e),b.kc().openEditUserModal()})),b.Mc(1,"Edit User"),b.Xb()}}function g(e,s){if(1&e){const e=b.Zb();b.Yb(0,"span",19),b.gc("click",(function(){return b.Ec(e),b.kc().resetPassword()})),b.Mc(1,"Reset Password"),b.Xb()}}function v(e,s){1&e&&(b.Yb(0,"span",20),b.Mc(1," Active"),b.Xb())}function _(e,s){1&e&&(b.Yb(0,"span",21),b.Mc(1,"Not Active"),b.Xb())}function X(e,s){if(1&e&&(b.Yb(0,"span",20),b.Mc(1),b.Xb()),2&e){const e=b.kc().$implicit;b.Db(1),b.Nc(e.shop_name)}}function w(e,s){if(1&e&&(b.Yb(0,"div",22),b.Yb(1,"div",23),b.Yb(2,"div",24),b.Yb(3,"h5",25),b.Mc(4),b.Xb(),b.Yb(5,"p",26),b.Mc(6),b.Xb(),b.Kc(7,X,2,1,"span",11),b.Xb(),b.Xb(),b.Xb()),2&e){const e=s.$implicit;b.Db(4),b.Nc(e.name),b.Db(2),b.Nc(e.description),b.Db(1),b.qc("ngIf",null==e?null:e.shop_name)}}const S=[{path:"profile",component:(()=>{class e{constructor(e,s,t,n,r){this._formBuilder=e,this._route=s,this._router=t,this._modalService=n,this._userService=r,this.page=new p.a,this.user=new h.a,this.shop=null,this.roleList=[]}ngOnInit(){this.userNumber=this._route.snapshot.paramMap.get("user_id"),this.shopNumber=this._route.snapshot.paramMap.get("id");let e=window.location.pathname.split("/").pop();this.userInfoForm=this._formBuilder.group({first_name:"",last_name:"",other_name:"",active_user:"",phone_number:"",email_address:""}),"profile"==e?(this.isUserProfile=!0,this.user=this._userService.getAuthenticatedUser(),this.roleList=[],this.user.roles.forEach(e=>{null!=e.shop_id&&null!=e.shop_id||(this.roleList.push({id:e.id,name:e.name,description:e.description}),this.roleList.slice())}),console.log(this.user.shops),this.user.shops.forEach(e=>{console.log("SHOP ID : "+e.id),this.user.roles.forEach(s=>{console.log("ROLE SHOP ID : "+s.shop_id),e.id==s.shop_id&&(this.roleList.push({id:s.id,name:s.name,description:s.description,shop_name:e.shop_name}),this.roleList.slice())})})):null==this.userNumber||null==this.userNumber?this._router.navigate(["/drop/shops"]):(this.getUserDetails(),this._modalService.closed.subscribe(()=>this.getUserDetails()))}getUserDetails(){this.roleList=[],this.loading=!0,this._userService.getUsers(this.page.pageNumber.toString(),"1",null,null,null,null,null,null,this.userNumber).subscribe(e=>{console.log(e),this.user=e.data[0],console.log(this.user),this.shop=Object(a.h)(this.user.shops,this.shopNumber),this.hasShopAdminRole=Object(a.i)(this.user.roles,3,this.shop.id),console.log(this.user.shops),null!=this.shopNumber&&null!=this.shopNumber&&this.user.shops.forEach(e=>{e.shop_number==this.shopNumber&&(this.shop=e)}),this.user.roles.forEach(e=>{e.shop_id==this.shop.id&&(this.roleList.push({id:e.id,name:e.name,description:e.description}),this.roleList.slice())}),this.loading=!1},e=>{this.loading=!1})}openEditUserModal(){this.modalRef=this._modalService.show(u.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-lg",data:{isEdit:!0,user:this.user,userShop:this.shop}})}resetPassword(){this.modalRef=this._modalService.show(c.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-md",data:{}})}}return e.\u0275fac=function(s){return new(s||e)(b.Sb(r.c),b.Sb(l.a),b.Sb(l.e),b.Sb(i.u),b.Sb(d.a))},e.\u0275cmp=b.Mb({type:e,selectors:[["app-profile"]],decls:42,vars:14,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"col-md-12","com-sm-12","col-xs-12"],[1,"nvb-bg","app-text-color"],[1,"mb-3"],["class","float-right btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"px-lg-5"],[1,"col-sm-6","col-md-4"],[1,"app-text-color","mb-1","section-edit-title"],["class","mr-2 badge badge-success",4,"ngIf"],["class","mr-2 badge badge-danger",4,"ngIf"],[1,"section-title","mb-3"],[1,"row","mb-3"],["class","col-sm-12 col-md-4 col-lg-4 col-xl-3 mb-3",4,"ngFor","ngForOf"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],[1,"float-right","btn","btn-primary","btn-sm",3,"click"],[1,"mr-2","badge","badge-success"],[1,"mr-2","badge","badge-danger"],[1,"col-sm-12","col-md-4","col-lg-4","col-xl-3","mb-3"],[1,"card"],[1,"card-body"],[1,"card-title","mb-1"],[1,"card-text","role-description"]],template:function(e,s){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",1),b.Kc(4,m,3,0,"div",3),b.Xb(),b.Yb(5,"div",1),b.Yb(6,"div",4),b.Yb(7,"mdb-card"),b.Yb(8,"mdb-card-header",5),b.Yb(9,"h2",6),b.Mc(10,"User Information "),b.Kc(11,f,2,0,"span",7),b.Kc(12,g,2,0,"span",7),b.Xb(),b.Xb(),b.Yb(13,"mdb-card-body",8),b.Yb(14,"div",1),b.Yb(15,"div",9),b.Yb(16,"p",10),b.Mc(17,"Names"),b.Xb(),b.Yb(18,"h2"),b.Mc(19),b.lc(20,"titlecase"),b.lc(21,"titlecase"),b.Xb(),b.Xb(),b.Yb(22,"div",9),b.Yb(23,"p",10),b.Mc(24,"Email"),b.Xb(),b.Yb(25,"h2"),b.Mc(26),b.Xb(),b.Xb(),b.Yb(27,"div",9),b.Yb(28,"p",10),b.Mc(29,"Phone Number"),b.Xb(),b.Yb(30,"h2"),b.Mc(31),b.Xb(),b.Xb(),b.Yb(32,"div",9),b.Yb(33,"p",10),b.Mc(34,"Status"),b.Xb(),b.Yb(35,"span"),b.Kc(36,v,2,0,"span",11),b.Kc(37,_,2,0,"span",12),b.Xb(),b.Xb(),b.Xb(),b.Yb(38,"h2",13),b.Mc(39,"User Roles"),b.Xb(),b.Yb(40,"div",14),b.Kc(41,w,8,3,"div",15),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(4),b.qc("ngIf",s.loading),b.Db(7),b.qc("ngIf",s.hasShopAdminRole),b.Db(1),b.qc("ngIf",s.isUserProfile),b.Db(7),b.Pc("",b.mc(20,10,null==s.user?null:s.user.first_name)," ",b.mc(21,12,null==s.user?null:s.user.last_name),""),b.Db(7),b.Nc(null==s.user?null:s.user.email_address),b.Db(5),b.Nc(null==s.user?null:s.user.phone_number),b.Db(5),b.qc("ngIf",1==(null==s.user?null:s.user.enabled)),b.Db(1),b.qc("ngIf",0==(null==s.user?null:s.user.enabled)),b.Db(4),b.qc("ngForOf",s.roleList))},directives:[n.j,i.y,i.z,i.x,n.i],pipes:[n.p],styles:[""]}),e})()}];let Y=(()=>{class e{}return e.\u0275mod=b.Qb({type:e}),e.\u0275inj=b.Pb({factory:function(s){return new(s||e)},imports:[[l.i.forChild(S)],l.i]}),e})();var E=t("TXLM");let M=(()=>{class e{}return e.\u0275mod=b.Qb({type:e}),e.\u0275inj=b.Pb({factory:function(s){return new(s||e)},imports:[[n.b,Y,r.g,r.q,i.r.forRoot(),i.N,o.b,E.a]]}),e})()},BCCV:function(e,s,t){"use strict";t.d(s,"a",(function(){return a}));var n=t("AytR"),r=t("tk/3"),i=t("2Vo4"),o=t("z6cu"),l=t("JIr8"),u=t("fXoL"),c=t("5eHb");let a=(()=>{class e{constructor(e,s){this._httpClient=e,this._toastr=s,this.baseUrl=n.a.base_url,this.shopIdSource=new i.a("default message"),this.shopId=this.shopIdSource.asObservable(),this.openShopsChange=new i.a(null),this.nearOpenShop=this.openShopsChange.asObservable()}createShop(e){return this._httpClient.post(this.baseUrl+"shop",e)}updateShop(e,s){return this._httpClient.put(this.baseUrl+"shop/"+e,s)}getShops(e,s,t,n,i,u){let c=(new r.e).set("page",e).set("page_size",s);return null!=i&&(c=c.append("shop_name",i)),null!=n&&(c=c.append("ids",n)),null!=t&&(c=c.append("operator_id",t)),null!=u&&(c=c.append("shop_number",u)),this._httpClient.get(this.baseUrl+"shop",{params:c}).pipe(Object(l.a)(e=>{if(e.error instanceof ErrorEvent);else{if(500===e.status)return this._toastr.error("An error occurred while getting shops"),Object(o.a)(e);if(401===e.status)return Object(o.a)(e);if(0===e.status)return this._toastr.error("Something went wrong, Please try again later"),Object(o.a)(e)}return this._toastr.error(e.error.api_code_description),Object(o.a)(e)}))}changeShopId(e){this.shopIdSource.next(e)}changeOpenShops(e){console.log("CHANGE SHOPS"),console.log(e),this.openShopsChange.next(e)}}return e.\u0275fac=function(s){return new(s||e)(u.cc(r.b),u.cc(c.b))},e.\u0275prov=u.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},lSn3:function(e,s,t){"use strict";function n(e){if(e&&(null!=e.value||null!=e.value)){let s=e.value;return new RegExp("^((?!.*[\\s])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,}))").test(s)?null:{weak:!0}}}function r(e){if(e&&(null!=e.value||null!=e.value)){const s=e.value,t=e.root.get("password");return t&&t.value!==s?{notmatch:!0}:null}}function i(e){if(e&&(null!=e.value||null!=e.value)){const s=e.value,t=e.root.get("confirmPassword");return!t||null==t&&null==t||!t.value||null==t.value&&null==t.value||s===t.value||e.root.get("confirmPassword").setValue(""),null}}function o(e){if(e&&(null!=e.value||null!=e.value)){let s=e.value;return new RegExp("\\S").test(s)?null:{hasWhiteSpace:!0}}}function l(e){if(e&&(null!=e.value||null!=e.value)){let s=e.value;return new RegExp("^((254[0-9]{9})|(07[0-9]{8}))$").test(s)?null:{invalidPhone:!0}}}function u(e){if(e&&(null!=e||null!=e))return{validPhone:new RegExp("^((254[0-9]{9})|(07[0-9]{8}))$").test(e)}}function c(e){if(e&&(null!=e||null!=e))return{validNumeric:new RegExp("^-?(0|[1-9]\\d*)?$").test(e)}}function a(e){if(e&&(null!=e.value||null!=e.value)){let s=e.value;return new RegExp("^-?([0-9]|([0-9]\\d*).?([0-9]\\d*))?$").test(s)?null:{invalidAmount:!0}}}function h(e,s,t){return null!=e&&null!=e&&0!=e.length&&function(e,s){let t=[];return e.forEach(e=>{e.shop_id==s&&(t.push(e.id),t.slice())}),t}(e,t).includes(s)}function p(e,s){let t=null;return null==e||null==e||0==e.length||e.forEach(e=>{e.shop_number==s&&(t={id:e.id,is_open:e.is_open,user_id:e.user_id,shop_number:e.shop_number,shop_name:e.shop_name,shop_location:e.shop_location,phone_number:e.phone_number,latitude:e.latitude,longitude:e.longitude})}),t}t.d(s,"j",(function(){return n})),t.d(s,"g",(function(){return r})),t.d(s,"f",(function(){return i})),t.d(s,"b",(function(){return o})),t.d(s,"d",(function(){return l})),t.d(s,"e",(function(){return u})),t.d(s,"c",(function(){return c})),t.d(s,"a",(function(){return a})),t.d(s,"i",(function(){return h})),t.d(s,"h",(function(){return p}))}}]);