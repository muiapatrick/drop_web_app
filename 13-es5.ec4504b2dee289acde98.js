function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{LxFr:function(e,t,o){"use strict";o.r(t),o.d(t,"ShopsModule",(function(){return de}));var i=o("ofXK"),s=o("3Pt+"),n=o("ZZCA"),r=o("Lm2G"),a=o("tyNb"),c=o("0Tvr"),b=o("fXoL"),l=o("4Q0Y"),h=o("BCCV");function d(e,t){1&e&&(b.Yb(0,"mdb-error"),b.Mc(1,"Enter shop name to search"),b.Xb())}function p(e,t){1&e&&(b.Yb(0,"div",21),b.Yb(1,"div",22),b.Tb(2,"div",23),b.Xb(),b.Xb())}function u(e,t){if(1&e){var o=b.Zb();b.Yb(0,"tr"),b.Yb(1,"td"),b.Mc(2),b.Xb(),b.Yb(3,"td"),b.Mc(4),b.Xb(),b.Yb(5,"td"),b.Mc(6),b.Xb(),b.Yb(7,"td"),b.Mc(8),b.Xb(),b.Yb(9,"td"),b.Tb(10,"mdb-checkbox",24),b.Xb(),b.Yb(11,"td"),b.Yb(12,"button",25),b.gc("click",(function(){b.Ec(o);var e=t.$implicit;return b.kc().viewShop(e)})),b.Mc(13,"View"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=t.$implicit,s=t.index,n=b.kc();b.Db(2),b.Oc("",n.itemNumber(s),"."),b.Db(2),b.Nc(i.shop_name),b.Db(2),b.Nc(i.phone_number),b.Db(2),b.Nc(i.shop_location),b.Db(2),b.qc("checked",i.is_open)("disabled",!0)}}var m,g=((m=function(){function e(t,o,i,s,n,r){_classCallCheck(this,e),this._formBuilder=t,this._userService=o,this._shopService=i,this._router=s,this._route=n,this._modalService=r,this.page=new c.a,this.MAX_SIZE=3,this.shopsList=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.user=this._userService.getAuthenticatedUser(),this.page.pageNumber=0,this.searchName="",this.searchForm=this._formBuilder.group({shop_name:["",s.s.compose([s.s.required])]}),this.searchForm.get("shop_name").valueChanges.pipe().subscribe((function(t){e.page.pageNumber=0,e.page_changed=!1,e.searchForm.valid?(e.loading=!0,e.searchName=t,e.getShops()):(e.searchName="",e.getShops())})),this.getShops()}},{key:"isTouched",value:function(e){return this.searchForm.controls[e].touched}},{key:"isInValid",value:function(e,t){return this.searchForm.controls[e].hasError(t)}},{key:"itemNumber",value:function(e){return this.page_changed?(this.page.pageNumber-1)*this.page.size+e+1:e+1}},{key:"pageChanged",value:function(e){this.page.pageNumber=e.page,this.page_changed=!0,this.getShops()}},{key:"getShops",value:function(){var e=this;this.loading=!0,this.shopsList=[],this._shopService.getShops(this.page.pageNumber.toString(),this.page.size.toString(),this.user.id.toString(),null,this.searchName).subscribe((function(t){console.log(t),e.page.totalElements=t.meta.total_elements,e.page.totalPages=t.meta.total_elements>0?Math.ceil(t.meta.total_elements/e.page.size):0,e.shopsList=t.data,e.loading=!1}),(function(t){e.loading=!1}))}},{key:"viewShop",value:function(e){this._router.navigate([e.shop_number],{relativeTo:this._route})}},{key:"addShop",value:function(){this._router.navigate(["add"],{relativeTo:this._route})}},{key:"isInvalidShopName",get:function(){return this.isInValid("shop_name","required")&&this.isTouched("shop_name")}}]),e}()).\u0275fac=function(e){return new(e||m)(b.Sb(s.c),b.Sb(l.a),b.Sb(h.a),b.Sb(a.e),b.Sb(a.a),b.Sb(n.u))},m.\u0275cmp=b.Mb({type:m,selectors:[["app-shops"]],decls:43,vars:8,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],[1,"card"],[1,"card-body","border-top"],[1,"col-md-12","col-lg-12","col-sm-12","mb-2"],[3,"formGroup"],[1,"col-sm-4","offset-sm-4"],[1,"md-form","text-center","mr-2","pr-1"],["id","shop_name","type","text","mdbInput","","mdbValidate","","formControlName","shop_name",1,"form-control"],["for","shop_name"],[4,"ngIf"],[1,"col-sm-4"],[1,"float-right","btn","btn-primary","btn-sm",3,"click"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"col-md-12","col-sm-12","col-sm-6"],[1,"table-responsive"],[1,"table","table-bordered","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],[1,"float-left","drop_table_pagenation",3,"maxSize","totalItems","ngModel","itemsPerPage","ngModelChange","pageChanged"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],[3,"checked","disabled"],[1,"btn","btn-primary","btn-sm","mr-2",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",3),b.Yb(4,"div",4),b.Yb(5,"div",1),b.Yb(6,"div",5),b.Yb(7,"form",6),b.Yb(8,"div",1),b.Yb(9,"div",7),b.Yb(10,"div",8),b.Tb(11,"input",9),b.Yb(12,"label",10),b.Mc(13,"Search by shop name"),b.Xb(),b.Kc(14,d,2,0,"mdb-error",11),b.Xb(),b.Xb(),b.Yb(15,"div",12),b.Yb(16,"div",8),b.Yb(17,"span",13),b.gc("click",(function(){return t.addShop()})),b.Mc(18,"Add Shop"),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(19,"div",1),b.Kc(20,p,3,0,"div",14),b.Xb(),b.Yb(21,"div",15),b.Yb(22,"div",16),b.Yb(23,"table",17),b.Yb(24,"caption"),b.Mc(25,"List of Shops"),b.Xb(),b.Yb(26,"thead"),b.Yb(27,"tr"),b.Yb(28,"th",18),b.Mc(29,"#"),b.Xb(),b.Yb(30,"th",18),b.Mc(31,"Name"),b.Xb(),b.Yb(32,"th",18),b.Mc(33,"Contact"),b.Xb(),b.Yb(34,"th",18),b.Mc(35,"Location"),b.Xb(),b.Yb(36,"th",18),b.Mc(37,"Is Open"),b.Xb(),b.Yb(38,"th",18),b.Mc(39,"Action"),b.Xb(),b.Xb(),b.Xb(),b.Yb(40,"tbody"),b.Kc(41,u,14,6,"tr",19),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(42,"pagination",20),b.gc("ngModelChange",(function(e){return t.page.pageNumber=e}))("pageChanged",(function(e){return t.pageChanged(e)})),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(7),b.qc("formGroup",t.searchForm),b.Db(7),b.qc("ngIf",t.isInvalidShopName),b.Db(6),b.qc("ngIf",t.loading),b.Db(21),b.qc("ngForOf",t.shopsList),b.Db(1),b.qc("maxSize",t.MAX_SIZE)("totalItems",t.page.totalElements)("ngModel",t.page.pageNumber)("itemsPerPage",t.page.size))},directives:[s.u,s.l,s.f,s.b,n.C,n.G,s.k,s.e,i.j,i.i,r.a,s.m,n.A,n.i],styles:[".card-body[_ngcontent-%COMP%]{padding-top:0;padding-right:0;padding-left:0}.md-form[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:.75rem}"]}),m),f=function e(){_classCallCheck(this,e)},v=function e(){_classCallCheck(this,e),this.new_dropping=0,this.accepted_items=0,this.release_requests=0,this.total_earning=0,this.shop_earning=0,this.drop_earning=0,this.weekly_accepted_items=0,this.weekly_release_requests=0,this.weekly_unpicked_requests=0,this.Weekly_total_earning=0,this.Weekly_shop_earning=0,this.Weekly_drop_earning=0,this.weekly_stats=[],this.stored_items=0},_=o("lSn3"),X=o("SJ6J"),Y=o("P6yk");function S(e,t){1&e&&(b.Yb(0,"div",41),b.Yb(1,"div",42),b.Tb(2,"div",43),b.Xb(),b.Xb())}function k(e,t){if(1&e){var o=b.Zb();b.Yb(0,"a",44),b.gc("click",(function(){return b.Ec(o),b.kc().openShopUsers()})),b.Tb(1,"i",45),b.Mc(2," Users "),b.Xb()}}function M(e,t){if(1&e){var o=b.Zb();b.Yb(0,"a",46),b.gc("click",(function(){return b.Ec(o),b.kc().openShopProfile()})),b.Tb(1,"i",47),b.Mc(2," Shop Profile "),b.Xb()}}function y(e,t){if(1&e){var o=b.Zb();b.Yb(0,"a",55),b.gc("click",(function(){b.Ec(o);var e=b.kc(2).$implicit;return b.kc().acceptDeclineItem("accept",e)})),b.Mc(1,"Accept"),b.Xb()}}function D(e,t){if(1&e){var o=b.Zb();b.Yb(0,"a",55),b.gc("click",(function(){b.Ec(o);var e=b.kc(2).$implicit;return b.kc().acceptDeclineItem("decline",e)})),b.Mc(1,"Decline"),b.Xb()}}function N(e,t){if(1&e){var o=b.Zb();b.Yb(0,"a",55),b.gc("click",(function(){b.Ec(o);var e=b.kc(2).$implicit;return b.kc().acceptDeclineItem("release",e)})),b.Mc(1,"Release"),b.Xb()}}function C(e,t){if(1&e&&(b.Yb(0,"div",50),b.Yb(1,"a",51),b.Tb(2,"i",52),b.Xb(),b.Yb(3,"div",53),b.Kc(4,y,2,0,"a",54),b.Kc(5,D,2,0,"a",54),b.Kc(6,N,2,0,"a",54),b.Xb(),b.Xb()),2&e){var o=b.kc().$implicit;b.Db(4),b.qc("ngIf",1===o.status.id),b.Db(1),b.qc("ngIf",1===o.status.id),b.Db(1),b.qc("ngIf",3===o.status.id)}}function w(e,t){if(1&e&&(b.Yb(0,"tr"),b.Yb(1,"td"),b.Mc(2),b.Xb(),b.Yb(3,"td"),b.Mc(4),b.Xb(),b.Yb(5,"td"),b.Mc(6),b.Xb(),b.Yb(7,"td"),b.Mc(8),b.Xb(),b.Yb(9,"td"),b.Mc(10),b.Xb(),b.Yb(11,"td"),b.Mc(12),b.Xb(),b.Yb(13,"td"),b.Mc(14),b.Xb(),b.Yb(15,"td"),b.Mc(16),b.Xb(),b.Yb(17,"td"),b.Mc(18),b.Xb(),b.Yb(19,"td",48),b.Kc(20,C,7,3,"div",49),b.Xb(),b.Xb()),2&e){var o=t.$implicit,i=t.index,s=b.kc();b.Db(2),b.Oc("",s.itemNumber(i),"."),b.Db(2),b.Nc(o.item_name),b.Db(2),b.Nc(o.item_description),b.Db(2),b.Nc(o.item_type),b.Db(2),b.Nc(o.hours_stored),b.Db(2),b.Nc(o.total_cost),b.Db(2),b.Nc(o.total_cost_paid),b.Db(2),b.Nc(o.total_cost_unpaid),b.Db(2),b.Nc(o.status.name),b.Db(2),b.qc("ngIf",1===o.status.id||3===o.status.id)}}function O(e,t){if(1&e){var o=b.Zb();b.Yb(0,"tr"),b.Yb(1,"td"),b.Mc(2),b.Xb(),b.Yb(3,"td"),b.Mc(4),b.Xb(),b.Yb(5,"td"),b.Mc(6),b.Xb(),b.Yb(7,"td"),b.Mc(8),b.Xb(),b.Yb(9,"td"),b.Tb(10,"mdb-checkbox",58),b.Xb(),b.Yb(11,"td",48),b.Yb(12,"button",59),b.gc("click",(function(){b.Ec(o);var e=t.$implicit;return b.kc(2).viewUser(e)})),b.Mc(13,"View"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=t.$implicit,s=t.index,n=b.kc(2);b.Db(2),b.Oc("",n.itemNumber(s),"."),b.Db(2),b.Nc(i.first_name+" "+i.last_name),b.Db(2),b.Nc(i.email_address),b.Db(2),b.Nc(i.phone_number),b.Db(2),b.qc("checked",i.enabled)("disabled",!0)}}function I(e,t){if(1&e){var o=b.Zb();b.Yb(0,"div",1),b.Yb(1,"div",19),b.Yb(2,"div",20),b.Yb(3,"h2"),b.Mc(4,"Shop "),b.Yb(5,"small"),b.Mc(6,"Operators"),b.Xb(),b.Xb(),b.Yb(7,"div",26),b.Yb(8,"div",34),b.Yb(9,"div",35),b.Yb(10,"table",56),b.Yb(11,"caption"),b.Mc(12,"List of Shop Operators"),b.Xb(),b.Yb(13,"thead"),b.Yb(14,"tr"),b.Yb(15,"th",37),b.Mc(16,"#"),b.Xb(),b.Yb(17,"th",37),b.Mc(18,"Name"),b.Xb(),b.Yb(19,"th",37),b.Mc(20,"Email"),b.Xb(),b.Yb(21,"th",37),b.Mc(22,"Phone"),b.Xb(),b.Yb(23,"th",37),b.Mc(24,"Active"),b.Xb(),b.Yb(25,"th",57),b.Mc(26,"Action"),b.Xb(),b.Xb(),b.Xb(),b.Yb(27,"tbody"),b.Kc(28,O,14,6,"tr",38),b.Xb(),b.Xb(),b.Yb(29,"a",39),b.gc("click",(function(){return b.Ec(o),b.kc().openShopUsers()})),b.Mc(30,"View All"),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=b.kc();b.Db(28),b.qc("ngForOf",i.userList)}}var L,F=((L=function(){function e(t,o,i,s,n,r,a){_classCallCheck(this,e),this._formBuilder=t,this._dropService=o,this._shopService=i,this._userService=s,this._router=n,this._route=r,this._modalService=a,this.today=new Date,this.page=new c.a,this.shop=new f,this.dropShopStats=new v,this.itemList=[],this.userList=[],this.chartType="line",this.chartDatasets=[{data:[0,0,0,0,0,0,0],label:"Drop Requests Handled"}],this.chartLabels=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],this.chartColors=[{backgroundColor:"rgba(0, 137, 132, .2)",borderColor:"rgba(0, 10, 130, .7)",borderWidth:2}],this.chartOptions={responsive:!0,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}},this.pickDateOptions={dateFormat:"yyyy-mm-dd",firstDayOfWeek:"mo",maxYear:this.today.getFullYear(),disableSince:{year:this.today.getFullYear(),month:this.today.getMonth()+1,day:this.today.getDate()+1}}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.shopNumber=window.location.pathname.split("/").pop(),this.user=this._userService.getAuthenticatedUser(),null==this.shopNumber&&null==this.shopNumber||(this.shop=Object(_.h)(this.user.shops,this.shopNumber),this.hasShopAdminRole=null!=this.shop&&null!=this.shop&&Object(_.i)(this.user.roles,3,this.shop.id),this.getShop()),this.dateFilterForm=this._formBuilder.group({pick_date:""}),this.dateFilterForm.controls.pick_date.setValue(this.today),this.dateFilterForm.get("pick_date").valueChanges.subscribe((function(t){e.loading=!0,e.getShopDropStats(),e.loading=!1})),null==this.shopNumber||null==this.shopNumber?this._router.navigate(["/drop/shops"]):this.getShopDetails(),this._modalService.closed.subscribe((function(){return e.getShopDetails()}))}},{key:"getShopDetails",value:function(){var e=this;this.loading=!0,this._userService.getUsers(this.page.pageNumber.toString(),"1",this.user.id.toString(),null,this.shopNumber,null,null,null).subscribe((function(t){e.user=t.data[0],e.shop=Object(_.h)(e.user.shops,e.shopNumber),e.hasShopAdminRole=Object(_.i)(e.user.roles,3,e.shop.id),e.getShop(),e.loading=!1}),(function(t){e.loading=!1}))}},{key:"getShop",value:function(){var e=this;this._shopService.getShops(this.page.pageNumber.toString(),"1",null,null,null,this.shopNumber).subscribe((function(t){e.shop=t.data[0],e.getShopDropStats(),e.getItems(),e.getShopUsers()}),(function(e){}))}},{key:"getItems",value:function(){var e=this;this.page.size=5,this.itemList=[],this._dropService.getItems(this.page.pageNumber.toString(),this.page.size.toString(),null,this.shop.id.toString(),null,null,null,this.shopNumber).subscribe((function(t){e.itemList=t.data}),(function(e){}))}},{key:"getShopUsers",value:function(){var e=this;this.page.size=5,this.userList=[],this._userService.getUsers(this.page.pageNumber.toString(),this.page.size.toString(),null,this.shop.id.toString(),this.shopNumber,null,null,null).subscribe((function(t){e.userList=t.data}),(function(e){}))}},{key:"getShopDropStats",value:function(){var e=this,t=new Date(this.dateFilterForm.get("pick_date").value).toISOString();this._dropService.getDropStats(this.shop.id.toString(),this.shopNumber,t).subscribe((function(t){e.dropShopStats=t.data,e.dropShopStats.stored_items=t.data.accepted_items+t.data.release_requests;var o=[];e.dropShopStats.weekly_stats.forEach((function(e){o.push(e.drop_count)})),e.chartDatasets=[{data:o,label:"Drop Requests Handled"}]}),(function(e){}))}},{key:"itemNumber",value:function(e){return e+1}},{key:"chartClicked",value:function(e){}},{key:"chartHovered",value:function(e){}},{key:"openRequests",value:function(e){this._dropService.setItemStatus(null!=e&&Object(_.c)(e).validNumeric?e:""),this._router.navigate(["items"],{relativeTo:this._route})}},{key:"openShopUsers",value:function(){this._router.navigate(["users"],{relativeTo:this._route})}},{key:"openShopProfile",value:function(){this._router.navigate(["profile"],{relativeTo:this._route})}},{key:"viewUser",value:function(e){this._router.navigate(["users/"+e.user_number],{relativeTo:this._route})}},{key:"acceptDeclineItem",value:function(e,t){this.modalRef=this._modalService.show(X.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-md cascading-modal",data:{action:e,item:t}})}}]),e}()).\u0275fac=function(e){return new(e||L)(b.Sb(s.c),b.Sb(Y.a),b.Sb(h.a),b.Sb(l.a),b.Sb(a.e),b.Sb(a.a),b.Sb(n.u))},L.\u0275cmp=b.Mb({type:L,selectors:[["app-shop"]],decls:150,vars:30,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],[1,"card"],[1,"card-body","border-top"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"row","justify-content-between","mb-2"],[1,"col-md-4"],[1,"col-md-5","offset-md-3","text-right","mr-0"],["rounded","true","mdbBtn","","mdbWavesEffect","",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-tint"],["class","btn btn-sm btn-info","rounded","true","mdbBtn","","mdbWavesEffect","",3,"click",4,"ngIf"],["class","btn btn-sm btn-secondary","rounded","true","mdbBtn","","mdbWavesEffect","",3,"click",4,"ngIf"],[1,"row","top_tiles"],[1,"animated","flipInY","col-lg-3","col-md-3","col-sm-6","col-xs-12"],["mdbWavesEffect","",1,"tile-stats",3,"click"],[1,"icon"],[1,"count"],[1,"tile-stats"],[1,"col-md-12"],[1,"x_panel"],[1,"x_title"],[1,"col-md-3","offset-sm-4"],[3,"formGroup"],[1,"md-form"],["name","pick_date","formControlName","pick_date",3,"inline","options"],[1,"x_content"],[1,"col-md-9","col-sm-12","col-xs-12"],[2,"display","block"],["mdbChart","",3,"chartType","datasets","labels","colors","options","legend","chartHover","chartClick"],["chart",""],[1,"col-md-3","col-sm-12","col-xs-12"],[1,"animated","flipInY","col-lg-12","col-md-12","col-sm-12","col-xs-12"],[1,"tile-stats","card"],[1,"col-md-12","com-sm-12","col-xs-12"],[1,"table-responsive"],[1,"table","table-hover"],["scope","col"],[4,"ngFor","ngForOf"],[1,"text-primary","float-right",3,"click"],["class","row",4,"ngIf"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],["rounded","true","mdbBtn","","mdbWavesEffect","",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-users"],["rounded","true","mdbBtn","","mdbWavesEffect","",1,"btn","btn-sm","btn-secondary",3,"click"],["aria-hidden","true",1,"fa","fa-bars"],[1,"text-center"],["class","dropdown waves-light","dropdown","","role","menu",4,"ngIf"],["dropdown","","role","menu",1,"dropdown","waves-light"],["dropdownToggle","","mdbWavesEffect","",1,"waves-light",2,"width","100%"],["aria-hidden","true",1,"fa","fa-ellipsis-v"],[1,"dropdown-menu"],["class","dropdown-item",3,"click",4,"ngIf"],[1,"dropdown-item",3,"click"],[1,"table","table-hover","table-sm"],["scope","col",1,"text-center"],[3,"checked","disabled"],[1,"btn","btn-primary","btn-sm","mr-2",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",3),b.Yb(4,"div",4),b.Yb(5,"div",1),b.Kc(6,S,3,0,"div",5),b.Xb(),b.Yb(7,"div",6),b.Yb(8,"div",7),b.Yb(9,"h2"),b.Mc(10),b.lc(11,"titlecase"),b.Yb(12,"small"),b.Mc(13),b.lc(14,"titlecase"),b.Tb(15,"br"),b.Mc(16),b.Xb(),b.Xb(),b.Xb(),b.Yb(17,"div",8),b.Yb(18,"a",9),b.gc("click",(function(){return t.openRequests()})),b.Tb(19,"i",10),b.Mc(20," Requests "),b.Xb(),b.Kc(21,k,3,0,"a",11),b.Kc(22,M,3,0,"a",12),b.Xb(),b.Xb(),b.Yb(23,"div",13),b.Yb(24,"div",14),b.Yb(25,"div",15),b.gc("click",(function(){return t.openRequests("1")})),b.Yb(26,"div",16),b.Tb(27,"i",10),b.Xb(),b.Yb(28,"div",17),b.Mc(29),b.Xb(),b.Yb(30,"h3"),b.Mc(31,"New Droppings"),b.Xb(),b.Yb(32,"p"),b.Mc(33,"Pending Acceptance"),b.Xb(),b.Xb(),b.Xb(),b.Yb(34,"div",14),b.Yb(35,"div",15),b.gc("click",(function(){return t.openRequests("2")})),b.Yb(36,"div",17),b.Mc(37),b.Xb(),b.Yb(38,"h3"),b.Mc(39,"Stored Items"),b.Xb(),b.Yb(40,"p"),b.Mc(41,"Items in store without pick requests"),b.Xb(),b.Xb(),b.Xb(),b.Yb(42,"div",14),b.Yb(43,"div",15),b.gc("click",(function(){return t.openRequests("3")})),b.Yb(44,"div",17),b.Yb(45,"small"),b.Mc(46),b.Xb(),b.Xb(),b.Yb(47,"h3"),b.Mc(48,"Pick Requests"),b.Xb(),b.Yb(49,"p"),b.Mc(50,"Items With pick Requests."),b.Xb(),b.Xb(),b.Xb(),b.Yb(51,"div",14),b.Yb(52,"div",18),b.Yb(53,"div",17),b.Yb(54,"small"),b.Mc(55),b.Xb(),b.Xb(),b.Yb(56,"h3"),b.Mc(57,"Today Earnings"),b.Xb(),b.Yb(58,"p"),b.Mc(59),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(60,"div",1),b.Yb(61,"div",19),b.Yb(62,"div",20),b.Yb(63,"div",21),b.Yb(64,"div",1),b.Yb(65,"div",7),b.Yb(66,"h2"),b.Mc(67,"Drop Summary "),b.Yb(68,"small"),b.Mc(69,"Weekly progress"),b.Xb(),b.Xb(),b.Xb(),b.Yb(70,"div",22),b.Yb(71,"form",23),b.Yb(72,"div",24),b.Tb(73,"mdb-date-picker",25),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(74,"div",26),b.Yb(75,"div",27),b.Yb(76,"div"),b.Yb(77,"div",28),b.Yb(78,"canvas",29,30),b.gc("chartHover",(function(e){return t.chartHovered(e)}))("chartClick",(function(e){return t.chartClicked(e)})),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(80,"div",31),b.Yb(81,"div",1),b.Yb(82,"div",32),b.Yb(83,"div",33),b.Yb(84,"div",4),b.Yb(85,"h4"),b.Mc(86,"Weekly Earnings"),b.Xb(),b.Yb(87,"h2"),b.Mc(88),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(89,"div",32),b.Yb(90,"div",33),b.Yb(91,"div",4),b.Yb(92,"h4"),b.Mc(93,"Weekly Accepted Items"),b.Xb(),b.Yb(94,"h2"),b.Mc(95),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(96,"div",32),b.Yb(97,"div",33),b.Yb(98,"div",4),b.Yb(99,"h4"),b.Mc(100,"Weekly Released Items"),b.Xb(),b.Yb(101,"h2"),b.Mc(102),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(103,"div",32),b.Yb(104,"div",33),b.Yb(105,"div",4),b.Yb(106,"h4"),b.Mc(107,"Weekly Unpicked Items"),b.Xb(),b.Yb(108,"h2"),b.Mc(109),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(110,"div",1),b.Yb(111,"div",19),b.Yb(112,"div",20),b.Yb(113,"h2"),b.Mc(114,"Recent "),b.Yb(115,"small"),b.Mc(116,"Drop Requests"),b.Xb(),b.Xb(),b.Yb(117,"div",26),b.Yb(118,"div",34),b.Yb(119,"div",35),b.Yb(120,"table",36),b.Yb(121,"caption"),b.Mc(122,"List of Drop Requests"),b.Xb(),b.Yb(123,"thead"),b.Yb(124,"tr"),b.Yb(125,"th",37),b.Mc(126,"#"),b.Xb(),b.Yb(127,"th",37),b.Mc(128,"Name"),b.Xb(),b.Yb(129,"th",37),b.Mc(130,"Description"),b.Xb(),b.Yb(131,"th",37),b.Mc(132,"Type"),b.Xb(),b.Yb(133,"th",37),b.Mc(134,"Hours"),b.Xb(),b.Yb(135,"th",37),b.Mc(136,"Cost"),b.Xb(),b.Yb(137,"th",37),b.Mc(138,"Paid"),b.Xb(),b.Yb(139,"th",37),b.Mc(140,"Balance"),b.Xb(),b.Yb(141,"th",37),b.Mc(142,"Status"),b.Xb(),b.Yb(143,"th",37),b.Mc(144,"Action"),b.Xb(),b.Xb(),b.Xb(),b.Yb(145,"tbody"),b.Kc(146,w,21,10,"tr",38),b.Xb(),b.Xb(),b.Yb(147,"a",39),b.gc("click",(function(){return t.openRequests()})),b.Mc(148,"View All"),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Kc(149,I,31,1,"div",40),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(6),b.qc("ngIf",t.loading),b.Db(4),b.Oc("",b.mc(11,26,null==t.shop?null:t.shop.shop_name)," - "),b.Db(3),b.Oc("",b.mc(14,28,(null==t.shop?null:t.shop.shop_location)+"")," "),b.Db(3),b.Oc(" ",null==t.shop?null:t.shop.phone_number,""),b.Db(5),b.qc("ngIf",t.hasShopAdminRole),b.Db(1),b.qc("ngIf",t.hasShopAdminRole),b.Db(7),b.Nc(t.dropShopStats.new_dropping),b.Db(8),b.Nc(t.dropShopStats.stored_items),b.Db(9),b.Nc(t.dropShopStats.release_requests),b.Db(9),b.Oc("KSH. ",t.dropShopStats.shop_earning,""),b.Db(4),b.Nc(t.today.getFullYear()+"-"+(t.today.getMonth()+1)+"-"+t.today.getDate()),b.Db(12),b.qc("formGroup",t.dateFilterForm),b.Db(2),b.qc("inline",!0)("options",t.pickDateOptions),b.Db(5),b.qc("chartType",t.chartType)("datasets",t.chartDatasets)("labels",t.chartLabels)("colors",t.chartColors)("options",t.chartOptions)("legend",!0),b.Db(10),b.Oc("Ksh. ",t.dropShopStats.Weekly_shop_earning,""),b.Db(7),b.Nc(t.dropShopStats.weekly_accepted_items),b.Db(7),b.Nc(t.dropShopStats.weekly_release_requests),b.Db(7),b.Nc(t.dropShopStats.weekly_unpicked_requests),b.Db(37),b.qc("ngForOf",t.itemList),b.Db(3),b.qc("ngIf",t.hasShopAdminRole))},directives:[i.j,n.w,n.M,s.u,s.l,s.f,n.s,s.k,s.e,n.c,i.i,n.d,n.e,n.i],pipes:[i.p],styles:[".dropdown-content[_ngcontent-%COMP%]{right:0!important;left:0!important}.dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%], .dropleft[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%], .dropright[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%], .dropup-material[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   .dropdown-item[_ngcontent-%COMP%]{padding:3px}.dropdown-menu[_ngcontent-%COMP%]{margin-top:0;min-width:4.5rem}.md-form[_ngcontent-%COMP%]{margin-top:0}.datepicker-inline-icon[_ngcontent-%COMP%]{top:0}.card-body[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem}.fixed-top-2[_ngcontent-%COMP%]{margin-top:60px;margin-left:230px!important}"]}),L),P=o("pSwl"),E=o("QR1q");function q(e,t){1&e&&(b.Yb(0,"mdb-error"),b.Mc(1,"Enter a name/phone to search"),b.Xb())}function x(e,t){1&e&&(b.Yb(0,"div",24),b.Yb(1,"div",25),b.Tb(2,"div",26),b.Xb(),b.Xb())}function A(e,t){if(1&e){var o=b.Zb();b.Yb(0,"tr"),b.Yb(1,"td"),b.Mc(2),b.Xb(),b.Yb(3,"td"),b.Mc(4),b.Xb(),b.Yb(5,"td"),b.Mc(6),b.Xb(),b.Yb(7,"td"),b.Mc(8),b.Xb(),b.Yb(9,"td"),b.Tb(10,"mdb-checkbox",27),b.Xb(),b.Yb(11,"td",28),b.Yb(12,"button",29),b.gc("click",(function(){b.Ec(o);var e=t.$implicit;return b.kc().viewUser(e)})),b.Mc(13,"View"),b.Xb(),b.Xb(),b.Xb()}if(2&e){var i=t.$implicit,s=t.index,n=b.kc();b.Db(2),b.Oc("",n.itemNumber(s),"."),b.Db(2),b.Nc(i.first_name+" "+i.last_name),b.Db(2),b.Nc(i.email_address),b.Db(2),b.Nc(i.phone_number),b.Db(2),b.qc("checked",i.enabled)("disabled",!0)}}var U,R=((U=function(){function e(t,o,i,s,n,r){_classCallCheck(this,e),this._formBuilder=t,this._route=o,this._router=i,this._modalService=s,this._shopService=n,this._userService=r,this.page=new c.a,this.MAX_SIZE=3,this.shop=new f,this.userList=[],this.first_name="Joel00"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.shopNumber=this._route.snapshot.paramMap.get("id"),console.log("SHOP NUMBER :: "+this.shopNumber),this.searchForm=this._formBuilder.group({search_value:["",s.s.compose([s.s.required])]}),this.searchForm.get("search_value").valueChanges.pipe().subscribe((function(t){e.page.pageNumber=0,e.page_changed=!1,e.searchForm.valid&&null!=t&&null!=t&&""!=t?(e.loading=!0,e.searchValue=t,e.searchField=Object(_.e)(e.searchValue).validPhone?"phone_number":"name",e.getUsers()):(e.searchField=null,e.searchValue=null,e.getUsers())})),null==this.shopNumber||null==this.shopNumber?this._router.navigate(["/drop/shops"]):this.getShopDetails(),this._modalService.closed.subscribe((function(){return e.getShopDetails()}))}},{key:"isTouched",value:function(e){return this.searchForm.controls[e].touched}},{key:"isInValid",value:function(e,t){return this.searchForm.controls[e].hasError(t)}},{key:"getShopDetails",value:function(){var e=this;this.loading=!0,this._shopService.getShops(this.page.pageNumber.toString(),"1",null,null,null,this.shopNumber).subscribe((function(t){console.log(t),e.shop=t.data[0],console.log(e.shop),e.getUsers()}),(function(t){e.loading=!1}))}},{key:"getUsers",value:function(){var e=this;this.loading=!0,this.userList=[],this._userService.getUsers(this.page.pageNumber.toString(),this.page.size.toString(),null,this.shop.id.toString(),this.shopNumber,null,null,null,null,this.searchField,this.searchValue).subscribe((function(t){console.log(t),e.userList=t.data,console.log(e.userList),e.loading=!1}),(function(t){e.loading=!1}))}},{key:"itemNumber",value:function(e){return this.page_changed?(this.page.pageNumber-1)*this.page.size+e+1:e+1}},{key:"pageChanged",value:function(e){console.log("EV PAGE :: "+e.page),console.log("PAGE NO :: "+this.page.pageNumber),this.page.pageNumber=e.page,console.log("PAGE NO :: "+this.page.pageNumber),this.page_changed=!0,this.getUsers()}},{key:"viewUser",value:function(e){console.log(e),console.log(e.user_number),this._router.navigate([e.user_number],{relativeTo:this._route})}},{key:"openUserModal",value:function(){this.modalRef=this._modalService.show(E.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-lg",data:{isEdit:!1,userShop:this.shop}})}},{key:"isInvalidSearchValue",get:function(){return this.isInValid("search_value","required")&&this.isTouched("search_value")}}]),e}()).\u0275fac=function(e){return new(e||U)(b.Sb(s.c),b.Sb(a.a),b.Sb(a.e),b.Sb(n.u),b.Sb(h.a),b.Sb(l.a))},U.\u0275cmp=b.Mb({type:U,selectors:[["app-users"]],decls:55,vars:14,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],[1,"card"],[1,"card-body","border-top"],[1,"row","mb-2"],[1,"col-md-4","mt-2"],[1,"col-md-4","offset-md-4"],[3,"formGroup"],[1,"md-form","text-center","mr-2","pr-1"],["id","search_value","type","text","mdbInput","","mdbValidate","","formControlName","search_value",1,"form-control"],["for","search_value"],[4,"ngIf"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"col-md-12","col-lg-12","col-sm-6"],[1,"float-right","btn","btn-primary","btn-sm",3,"click"],["aria-hidden","true",1,"fa","fa-user-plus"],[1,"col-md-12","com-sm-12","col-xs-12"],[1,"table-responsive"],[1,"table","table-hover","table-sm"],["scope","col"],["scope","col",1,"text-center"],[4,"ngFor","ngForOf"],[1,"float-left","drop_table_pagenation",3,"maxSize","totalItems","ngModel","itemsPerPage","ngModelChange","pageChanged"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],[3,"checked","disabled"],[1,"text-center"],[1,"btn","btn-primary","btn-sm","mr-2",2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",3),b.Yb(4,"div",4),b.Yb(5,"div",5),b.Yb(6,"div",6),b.Yb(7,"h2"),b.Mc(8),b.lc(9,"titlecase"),b.Yb(10,"small"),b.Mc(11,"Shop Operators"),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(12,"div",5),b.Yb(13,"div",6),b.Yb(14,"h2"),b.Mc(15),b.lc(16,"titlecase"),b.Yb(17,"small"),b.Mc(18,"Shop Operators"),b.Xb(),b.Xb(),b.Xb(),b.Yb(19,"div",7),b.Yb(20,"form",8),b.Yb(21,"div",9),b.Tb(22,"input",10),b.Yb(23,"label",11),b.Mc(24,"Search by name/phone"),b.Xb(),b.Kc(25,q,2,0,"mdb-error",12),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(26,"div",1),b.Kc(27,x,3,0,"div",13),b.Yb(28,"div",14),b.Yb(29,"span",15),b.gc("click",(function(){return t.openUserModal()})),b.Tb(30,"i",16),b.Mc(31,"Add User"),b.Xb(),b.Xb(),b.Xb(),b.Yb(32,"div",1),b.Yb(33,"div",17),b.Yb(34,"div",18),b.Yb(35,"table",19),b.Yb(36,"caption"),b.Mc(37,"List of Shop Operators"),b.Xb(),b.Yb(38,"thead"),b.Yb(39,"tr"),b.Yb(40,"th",20),b.Mc(41,"#"),b.Xb(),b.Yb(42,"th",20),b.Mc(43,"Name"),b.Xb(),b.Yb(44,"th",20),b.Mc(45,"Email"),b.Xb(),b.Yb(46,"th",20),b.Mc(47,"Phone"),b.Xb(),b.Yb(48,"th",20),b.Mc(49,"Active"),b.Xb(),b.Yb(50,"th",21),b.Mc(51,"Action"),b.Xb(),b.Xb(),b.Xb(),b.Yb(52,"tbody"),b.Kc(53,A,14,6,"tr",22),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Yb(54,"pagination",23),b.gc("ngModelChange",(function(e){return t.page.pageNumber=e}))("pageChanged",(function(e){return t.pageChanged(e)})),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(8),b.Oc("",b.mc(9,10,t.first_name)," - "),b.Db(7),b.Oc("",b.mc(16,12,t.shop.shop_name)," - "),b.Db(5),b.qc("formGroup",t.searchForm),b.Db(5),b.qc("ngIf",t.isInvalidSearchValue),b.Db(2),b.qc("ngIf",t.loading),b.Db(26),b.qc("ngForOf",t.userList),b.Db(1),b.qc("maxSize",t.MAX_SIZE)("totalItems",t.page.totalElements)("ngModel",t.page.pageNumber)("itemsPerPage",t.page.size))},directives:[s.u,s.l,s.f,s.b,n.C,n.G,s.k,s.e,i.j,i.i,r.a,s.m,n.A,n.i],pipes:[i.p],styles:[".card-body[_ngcontent-%COMP%]{padding-top:0;padding-right:0}.md-form[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:.75rem}"]}),U),T=o("jZhJ"),V=o("5vxX");function B(e,t){1&e&&(b.Yb(0,"div",16),b.Yb(1,"div",17),b.Tb(2,"div",18),b.Xb(),b.Xb())}function K(e,t){if(1&e){var o=b.Zb();b.Yb(0,"span",19),b.gc("click",(function(){return b.Ec(o),b.kc().openEditUserModal()})),b.Mc(1,"Edit User"),b.Xb()}}function z(e,t){if(1&e){var o=b.Zb();b.Yb(0,"span",19),b.gc("click",(function(){return b.Ec(o),b.kc().resetPassword()})),b.Mc(1,"Reset Password"),b.Xb()}}function Z(e,t){1&e&&(b.Yb(0,"span",20),b.Mc(1," Active"),b.Xb())}function j(e,t){1&e&&(b.Yb(0,"span",21),b.Mc(1,"Not Active"),b.Xb())}function W(e,t){if(1&e&&(b.Yb(0,"span",20),b.Mc(1),b.Xb()),2&e){var o=b.kc().$implicit;b.Db(1),b.Nc(o.shop_name)}}function G(e,t){if(1&e&&(b.Yb(0,"div",22),b.Yb(1,"div",23),b.Yb(2,"div",24),b.Yb(3,"h5",25),b.Mc(4),b.Xb(),b.Yb(5,"p",26),b.Mc(6),b.Xb(),b.Kc(7,W,2,1,"span",11),b.Xb(),b.Xb(),b.Xb()),2&e){var o=t.$implicit;b.Db(4),b.Nc(o.name),b.Db(2),b.Nc(o.description),b.Db(1),b.qc("ngIf",null==o?null:o.shop_name)}}var H,$=((H=function(){function e(t,o,i,s,n){_classCallCheck(this,e),this._formBuilder=t,this._route=o,this._router=i,this._modalService=s,this._userService=n,this.page=new c.a,this.user=new T.a,this.shop=null,this.roleList=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.userNumber=this._route.snapshot.paramMap.get("user_id"),this.shopNumber=this._route.snapshot.paramMap.get("id");var t=window.location.pathname.split("/").pop();this.userInfoForm=this._formBuilder.group({first_name:"",last_name:"",other_name:"",active_user:"",phone_number:"",email_address:""}),"profile"==t?(this.isUserProfile=!0,this.user=this._userService.getAuthenticatedUser(),this.roleList=[],this.user.roles.forEach((function(t){null!=t.shop_id&&null!=t.shop_id||(e.roleList.push({id:t.id,name:t.name,description:t.description}),e.roleList.slice())})),console.log(this.user.shops),this.user.shops.forEach((function(t){console.log("SHOP ID : "+t.id),e.user.roles.forEach((function(o){console.log("ROLE SHOP ID : "+o.shop_id),t.id==o.shop_id&&(e.roleList.push({id:o.id,name:o.name,description:o.description,shop_name:t.shop_name}),e.roleList.slice())}))}))):null==this.userNumber||null==this.userNumber?this._router.navigate(["/drop/shops"]):(this.getUserDetails(),this._modalService.closed.subscribe((function(){return e.getUserDetails()})))}},{key:"getUserDetails",value:function(){var e=this;this.roleList=[],this.loading=!0,this._userService.getUsers(this.page.pageNumber.toString(),"1",null,null,null,null,null,null,this.userNumber).subscribe((function(t){console.log(t),e.user=t.data[0],console.log(e.user),e.shop=Object(_.h)(e.user.shops,e.shopNumber),e.hasShopAdminRole=Object(_.i)(e.user.roles,3,e.shop.id),console.log(e.user.shops),null!=e.shopNumber&&null!=e.shopNumber&&e.user.shops.forEach((function(t){t.shop_number==e.shopNumber&&(e.shop=t)})),e.user.roles.forEach((function(t){t.shop_id==e.shop.id&&(e.roleList.push({id:t.id,name:t.name,description:t.description}),e.roleList.slice())})),e.loading=!1}),(function(t){e.loading=!1}))}},{key:"openEditUserModal",value:function(){this.modalRef=this._modalService.show(E.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-lg",data:{isEdit:!0,user:this.user,userShop:this.shop}})}},{key:"resetPassword",value:function(){this.modalRef=this._modalService.show(V.a,{backdrop:!0,ignoreBackdropClick:!0,class:"modal-md",data:{}})}}]),e}()).\u0275fac=function(e){return new(e||H)(b.Sb(s.c),b.Sb(a.a),b.Sb(a.e),b.Sb(n.u),b.Sb(l.a))},H.\u0275cmp=b.Mb({type:H,selectors:[["app-user"]],decls:42,vars:14,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"col-md-12","com-sm-12","col-xs-12"],[1,"nvb-bg","app-text-color"],[1,"mb-3"],["class","float-right btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"px-lg-5"],[1,"col-sm-6","col-md-4"],[1,"app-text-color","mb-1","section-edit-title"],["class","mr-2 badge badge-success",4,"ngIf"],["class","mr-2 badge badge-danger",4,"ngIf"],[1,"section-title","mb-3"],[1,"row","mb-3"],["class","col-sm-12 col-md-4 col-lg-4 col-xl-3 mb-3",4,"ngFor","ngForOf"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],[1,"float-right","btn","btn-primary","btn-sm",3,"click"],[1,"mr-2","badge","badge-success"],[1,"mr-2","badge","badge-danger"],[1,"col-sm-12","col-md-4","col-lg-4","col-xl-3","mb-3"],[1,"card"],[1,"card-body"],[1,"card-title","mb-1"],[1,"card-text","role-description"]],template:function(e,t){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",1),b.Kc(4,B,3,0,"div",3),b.Xb(),b.Yb(5,"div",1),b.Yb(6,"div",4),b.Yb(7,"mdb-card"),b.Yb(8,"mdb-card-header",5),b.Yb(9,"h2",6),b.Mc(10,"User Information "),b.Kc(11,K,2,0,"span",7),b.Kc(12,z,2,0,"span",7),b.Xb(),b.Xb(),b.Yb(13,"mdb-card-body",8),b.Yb(14,"div",1),b.Yb(15,"div",9),b.Yb(16,"p",10),b.Mc(17,"Names"),b.Xb(),b.Yb(18,"h2"),b.Mc(19),b.lc(20,"titlecase"),b.lc(21,"titlecase"),b.Xb(),b.Xb(),b.Yb(22,"div",9),b.Yb(23,"p",10),b.Mc(24,"Email"),b.Xb(),b.Yb(25,"h2"),b.Mc(26),b.Xb(),b.Xb(),b.Yb(27,"div",9),b.Yb(28,"p",10),b.Mc(29,"Phone Number"),b.Xb(),b.Yb(30,"h2"),b.Mc(31),b.Xb(),b.Xb(),b.Yb(32,"div",9),b.Yb(33,"p",10),b.Mc(34,"Status"),b.Xb(),b.Yb(35,"span"),b.Kc(36,Z,2,0,"span",11),b.Kc(37,j,2,0,"span",12),b.Xb(),b.Xb(),b.Xb(),b.Yb(38,"h2",13),b.Mc(39,"User Roles"),b.Xb(),b.Yb(40,"div",14),b.Kc(41,G,8,3,"div",15),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(4),b.qc("ngIf",t.loading),b.Db(7),b.qc("ngIf",t.hasShopAdminRole),b.Db(1),b.qc("ngIf",t.isUserProfile),b.Db(7),b.Pc("",b.mc(20,10,null==t.user?null:t.user.first_name)," ",b.mc(21,12,null==t.user?null:t.user.last_name),""),b.Db(7),b.Nc(null==t.user?null:t.user.email_address),b.Db(5),b.Nc(null==t.user?null:t.user.phone_number),b.Db(5),b.qc("ngIf",1==(null==t.user?null:t.user.enabled)),b.Db(1),b.qc("ngIf",0==(null==t.user?null:t.user.enabled)),b.Db(4),b.qc("ngForOf",t.roleList))},directives:[i.j,n.y,n.z,n.x,i.i],pipes:[i.p],styles:[""]}),H),J=o("pxUr"),Q=o("5eHb"),ee=o("GBiA"),te=["search"];function oe(e,t){1&e&&(b.Yb(0,"div",27),b.Yb(1,"div",28),b.Tb(2,"div",29),b.Xb(),b.Xb())}function ie(e,t){if(1&e){var o=b.Zb();b.Yb(0,"span",30),b.gc("click",(function(){return b.Ec(o),b.kc().postShop()})),b.Mc(1),b.Xb()}if(2&e){var i=b.kc();b.Db(1),b.Nc(i.buttonActionLabel)}}var se,ne,re,ae=function(e){return{hidden:e}},ce=((se=function(){function e(t,o,i,s,n,r,a,b,l,h){_classCallCheck(this,e),this._formBuilder=t,this._mapsAPILoader=o,this._ngZone=i,this._route=s,this._router=n,this._location=r,this._shopService=a,this._toastr=b,this._userService=l,this._openShopService=h,this.page=new c.a,this.pageAction="Shop Information",this.buttonActionLabel="Save",this.zoom=15}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.shopNumber=this._route.snapshot.paramMap.get("id"),this.pathName=window.location.pathname.split("/").pop(),this.user=this._userService.getAuthenticatedUser(),this.shopForm=this._formBuilder.group({shop_name:["",s.s.compose([s.s.required,_.b])],phone_number:["",s.s.compose([s.s.required,_.b])],shop_location:["",s.s.compose([s.s.required,_.b])],open_status:[""],search_control:[""]}),null==this.shopNumber&&null==this.shopNumber||(this.shop=Object(_.h)(this.user.shops,this.shopNumber),null!=this.shop?(this.hasShopAdminRole=!(!Object(_.i)(this.user.roles,3,this.shop.id)&&this.shop.user_id!=this.user.id),this.currentLat=this.shop.latitude,this.currentLong=this.shop.longitude,this.shopMarker={lat:this.currentLat,lng:this.currentLong,draggable:!0,clickable:!1,label:"Current shop location(Drag to Change)",animation:"BOUNCE",title:this.shop.shop_name.toUpperCase()+" - "+this.shop.shop_location},this.buttonActionLabel="Save Changes",this.setShopFormValues()):(this.getShopDetails(),this.buttonActionLabel="Save Changes")),this.canEdit=!("add"!=this.pathName&&!this.hasShopAdminRole),this._mapsAPILoader.load().then((function(){"new"==e.action&&e.setCurrentLocation();var t=new google.maps.places.Autocomplete(e.searchElementRef.nativeElement);t.addListener("place_changed",(function(){e._ngZone.run((function(){var o=t.getPlace();null!=o.geometry&&(e.currentLat=o.geometry.location.lat(),e.currentLong=o.geometry.location.lng(),e.shopMarker={lat:e.currentLat,lng:e.currentLong,draggable:!0,clickable:!1,label:"Current shop location(Drag to Change)",animation:"BOUNCE",title:"Your Shop is located at "+o.name})}))}))}))}},{key:"getShopDetails",value:function(){var e=this;this.loading=!0,this._userService.getUsers(this.page.pageNumber.toString(),"1",this.user.id.toString(),null,this.shopNumber,null,null,null).subscribe((function(t){e.user=t.data[0],e.shop=Object(_.h)(e.user.shops,e.shopNumber),e.hasShopAdminRole=!(!Object(_.i)(e.user.roles,3,e.shop.id)&&e.shop.user_id!=e.user.id),e.setShopFormValues(),e.currentLat=e.shop.latitude,e.currentLong=e.shop.longitude,e.shopMarker={lat:e.currentLat,lng:e.currentLong,draggable:!0,clickable:!1,label:"Current shop location(Drag to Change)",animation:"BOUNCE",title:e.shop.shop_name.toUpperCase()+" - "+e.shop.shop_location},e.setShopFormValues(),e.loading=!1}),(function(t){e.loading=!1}))}},{key:"setShopFormValues",value:function(){this.canEdit=!("add"!=this.pathName&&!this.hasShopAdminRole),this.pageAction="add"==this.pathName?"Add New Shop":this.pageAction,null!=this.shop&&(this.shopForm.get("shop_name").setValue(this.shop.shop_name),this.shopForm.get("phone_number").setValue(this.shop.phone_number),this.shopForm.get("shop_location").setValue(this.shop.shop_location),this.shopForm.get("open_status").setValue(this.shop.is_open),this.enableDisableFormFields())}},{key:"enableDisableFormFields",value:function(){this.canEdit?(this.shopForm.get("shop_name").enable(),this.shopForm.get("phone_number").enable(),this.shopForm.get("shop_location").enable(),this.shopForm.get("open_status").enable(),this.shopForm.get("search_control").enable()):(this.shopForm.get("shop_name").disable(),this.shopForm.get("phone_number").disable(),this.shopForm.get("shop_location").disable(),this.shopForm.get("open_status").disable(),this.shopForm.get("search_control").disable())}},{key:"setCurrentLocation",value:function(){var e=this;"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(t){e.currentLat=t.coords.latitude,e.currentLong=t.coords.longitude,e.shopMarker={lat:e.currentLat,lng:e.currentLong,draggable:!0,clickable:!1,label:"Drag the Red marker to where your shop is located.",animation:"BOUNCE",title:"My Position"}}),(function(t){e._toastr.error("Unable to access your current location")})):alert("Geolocation not supported!!")}},{key:"mapReady",value:function(e){this.map=e,this.map.controls[google.maps.ControlPosition.TOP_CENTER].push(document.getElementById("search-control"))}},{key:"markerDragEnd",value:function(e,t){this.currentLat=t.coords.lat,this.currentLong=t.coords.lng,this.shopMarker={lat:this.currentLat,lng:this.currentLong,draggable:!0,clickable:!1,label:"Drag the Red marker to where your shop is located.",animation:"BOUNCE",title:"Customers will see your shop here"}}},{key:"postShop",value:function(){var e=this,t={is_open:this.shopForm.get("open_status").value,phone_number:this.shopForm.get("phone_number").value,shop_name:this.shopForm.get("shop_name").value,shop_location:this.shopForm.get("shop_location").value,latitude:this.shopMarker.lat,longitude:this.shopMarker.lng};console.log(t),"add"==this.pathName?this._shopService.createShop(t).subscribe((function(t){var o=t.data;e._openShopService.addStore(o.id.toString(),o.shop_name,o.latitude,o.longitude),e._toastr.success("Shop added successful","SUCCESSFULL"),e.shopForm.reset(),e.setCurrentLocation(),e._location.back()}),(function(t){console.log(t),400==t.status&&e._toastr.error("Invalid Request Parameters not permitted"),409==t.status&&e._toastr.error(t.error.api_code_description),console.log(t)})):this._shopService.updateShop(this.shop.id.toString(),t).subscribe((function(t){var o=t.data;e._openShopService.addStore(o.id.toString(),o.shop_name,o.latitude,o.longitude),e._toastr.success("Shop Details updated successful","SUCCESSFULL"),e.shopForm.reset(),e.setCurrentLocation(),e._location.back()}),(function(t){console.log(t),400==t.status&&e._toastr.error("Invalid Request Parameters not permitted"),console.log(t)}))}}]),e}()).\u0275fac=function(e){return new(e||se)(b.Sb(s.c),b.Sb(J.f),b.Sb(b.A),b.Sb(a.a),b.Sb(a.e),b.Sb(i.f),b.Sb(h.a),b.Sb(Q.b),b.Sb(l.a),b.Sb(ee.a))},se.\u0275cmp=b.Mb({type:se,selectors:[["app-shop-profile"]],viewQuery:function(e,t){var o;1&e&&b.Sc(te,!0),2&e&&b.Ac(o=b.hc())&&(t.searchElementRef=o.first)},decls:48,vars:24,consts:[[1,"drop_content"],[1,"row"],[1,"col-md-12","mb-4",2,"padding-top","5px"],["class","col-md-12 col-lg-12 col-sm-6 overlay",4,"ngIf"],[1,"col-md-12","com-sm-12","col-xs-12"],[1,"nvb-bg","app-text-color"],[1,"mb-3"],["class","float-right btn btn-primary btn-sm",3,"click",4,"ngIf"],[1,"px-lg-5"],[3,"formGroup"],[1,"col-sm-6","col-md-4"],[1,"md-form"],["id","shop_name","type","text","mdbInput","","mdbValidate","","formControlName","shop_name",1,"form-control",2,"text-transform","capitalize"],["for","shop_name"],["id","phone_number","type","text","mdbInput","","mdbValidate","","formControlName","phone_number",1,"form-control",2,"text-transform","capitalize"],["id","shop_location","type","text","mdbInput","","mdbValidate","","formControlName","shop_location",1,"form-control",2,"text-transform","capitalize"],["for","shop_location"],[1,"col-sm-2"],["formControlName","open_status",3,"checked","click"],[1,"section-title","mb-1"],[1,"row","mb-3"],["id","map"],[3,"latitude","longitude","zoom","minZoom","maxZoom","fullscreenControl","fullscreenControlOptions","streetViewControl","mapReady"],["id","search-control",1,"form-group","w-75","controls","mt-1"],["type","text","formControlName","search_control","placeholder","Search location by name, or building or road where your shop is located","autocorrect","off","autocapitalize","off","spellcheck","off",1,"form-control",3,"ngClass","key.enter"],["search",""],[3,"markerClickable","latitude","longitude","label","markerDraggable","iconUrl","animation","dragEnd"],[1,"col-md-12","col-lg-12","col-sm-6","overlay"],[1,"spinner-wrapper"],[1,"spinner"],[1,"float-right","btn","btn-primary","btn-sm",3,"click"]],template:function(e,t){1&e&&(b.Yb(0,"div",0),b.Yb(1,"div",1),b.Yb(2,"div",2),b.Yb(3,"div",1),b.Kc(4,oe,3,0,"div",3),b.Xb(),b.Yb(5,"div",1),b.Yb(6,"div",4),b.Yb(7,"mdb-card"),b.Yb(8,"mdb-card-header",5),b.Yb(9,"h2",6),b.Mc(10),b.Kc(11,ie,2,1,"span",7),b.Xb(),b.Xb(),b.Yb(12,"mdb-card-body",8),b.Yb(13,"form",9),b.Yb(14,"div",1),b.Yb(15,"div",10),b.Yb(16,"div",11),b.Tb(17,"input",12),b.Yb(18,"label",13),b.Mc(19,"Shop Name"),b.Xb(),b.Xb(),b.Xb(),b.Yb(20,"div",10),b.Yb(21,"div",11),b.Tb(22,"input",14),b.Yb(23,"label",13),b.Mc(24,"Phone Number"),b.Xb(),b.Xb(),b.Xb(),b.Yb(25,"div",10),b.Yb(26,"div",11),b.Tb(27,"input",15),b.Yb(28,"label",16),b.Mc(29,"Physical Location"),b.Xb(),b.Xb(),b.Xb(),b.Yb(30,"div",10),b.Yb(31,"div",17),b.Yb(32,"label"),b.Mc(33,"Open"),b.Xb(),b.Xb(),b.Yb(34,"mdb-checkbox",18),b.gc("click",(function(e){return e.stopPropagation()})),b.Xb(),b.Xb(),b.Xb(),b.Yb(35,"h2",19),b.Mc(36,"Location on Map"),b.Xb(),b.Yb(37,"div",20),b.Yb(38,"div",2),b.Yb(39,"div",21),b.Yb(40,"agm-map",22),b.gc("mapReady",(function(e){return t.mapReady(e)})),b.Yb(41,"div",23),b.Yb(42,"input",24,25),b.gc("key.enter",(function(e){return e.preventDefault()})),b.Xb(),b.Xb(),b.Yb(44,"agm-marker",26),b.gc("dragEnd",(function(e){return t.markerDragEnd(t.shopMarker,e)})),b.Yb(45,"agm-info-window"),b.Yb(46,"strong"),b.Mc(47),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb(),b.Xb()),2&e&&(b.Db(4),b.qc("ngIf",t.loading),b.Db(6),b.Oc("",t.pageAction," "),b.Db(1),b.qc("ngIf",t.canEdit),b.Db(2),b.qc("formGroup",t.shopForm),b.Db(21),b.qc("checked",!1),b.Db(6),b.qc("latitude",t.currentLat)("longitude",t.currentLong)("zoom",t.zoom)("minZoom",7)("maxZoom",20)("fullscreenControl",!0)("fullscreenControlOptions",t.screenOptions)("streetViewControl",!1),b.Db(2),b.qc("ngClass",b.uc(22,ae,t.shopForm.controls.search_control.disabled)),b.Db(2),b.qc("markerClickable",!1)("latitude",null==t.shopMarker?null:t.shopMarker.lat)("longitude",null==t.shopMarker?null:t.shopMarker.lng)("label",null==t.shopMarker?null:t.shopMarker.label)("markerDraggable",null==t.shopMarker?null:t.shopMarker.draggable)("iconUrl",null==t.shopMarker?null:t.shopMarker.icon)("animation",null==t.shopMarker?null:t.shopMarker.animation),b.Db(3),b.Nc(null==t.shopMarker?null:t.shopMarker.title))},directives:[i.j,n.y,n.z,n.x,s.u,s.l,s.f,s.b,n.C,n.G,s.k,s.e,n.i,J.c,i.h,J.d,J.b],styles:["#map[_ngcontent-%COMP%]{width:100%}agm-map[_ngcontent-%COMP%]{height:400px}"]}),se),be=[{path:"",component:g},{path:"add",component:ce},{path:":id",component:F},{path:":id/items",component:P.a},{path:":id/users",component:R},{path:":id/users/:user_id",component:$},{path:":id/profile",component:ce}],le=((ne=function e(){_classCallCheck(this,e)}).\u0275mod=b.Qb({type:ne}),ne.\u0275inj=b.Pb({factory:function(e){return new(e||ne)},imports:[[a.i.forChild(be)],a.i]}),ne),he=o("TXLM"),de=((re=function e(){_classCallCheck(this,e)}).\u0275mod=b.Qb({type:re}),re.\u0275inj=b.Pb({factory:function(e){return new(e||re)},imports:[[i.b,le,s.g,s.q,n.r.forRoot(),n.h,n.L,n.N,r.b,J.a.forRoot({apiKey:"AIzaSyC_2bjO2wL-sv-Gaq94-j63rHm2Jo8SJB8",libraries:["places"]}),he.a]]}),re)}}]);